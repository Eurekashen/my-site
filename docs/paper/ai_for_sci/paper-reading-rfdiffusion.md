!!! Warning
	Most of the paper is devoted to experimental results and how awesome the results are. Only tiny part of the paper introduce the model and motivation&pipeline of RFdiffusion. The paper is so long and hard to read that maybe I don't have a good understanding of the idea. If I hava some misunderstanding of the paper, please forgive me. I will be grateful if you can point out the mistakes. 

!!! note
	As far as i am concerned, I think the keypoints of the paper are as follows
* Fine-tuning from RoseTTAFold.
* Self conditioning traning trick.
* Can design high-order symmetric oligomers which previous model can't.

## Introduction

### The paradigm of protien design

<a href="https://www.imagehub.cc/image/1eXyV7"><img src="https://s1.imagehub.cc/images/2023/10/31/2cf338ae7eb7ca624cc4e23a82c87586.png" alt="2cf338ae7eb7ca624cc4e23a82c87586.png" border="0" /></a>

The sequence design step also known as inverse folding we have got ProteinMPNN.

 And we use AlphaFold, ESMFolD, RoseTTAFold etc. to filter the design result. If the models can't fold the sequence generated by the inverse folding step, we think the designed structure has low designability.

In the end, we do experimental characterisation. 

> This step is usually based on in silico simulation

## Some interesting related works

* Energy based searching——Inefficient and expensive

* Hallucination and Inpainting

  [![325b57183beb3d79dd72daa7d799590f.png](https://s1.imagehub.cc/images/2023/10/31/325b57183beb3d79dd72daa7d799590f.png)](https://www.imagehub.cc/image/1eXZht)

  These two methods are focused on the task which given some known motif or significant functional parts and design some new structures with the specific function. In the section below, the paper shows the result about scaffolding and peptide binder design.


!!! note "Hallucination"
	The hallucination is often appear in the large language models. For example, we give the model an input "explain the content of human.pdf" and the model like ChatGPT is more likely to output explaination related to "human". In our scenario, we want to the model "make it up" based on the input motifs. In my opinion, the hallucination is a sort of generalization.


!!! note "Inpaiting"
	The biggest difference between hallucination and inpainting design is that the input motifs must appear in the inpainting designed sequence but unlikely to appear in the hallucination designed one.


## Model Details

### Diffusion model

[![915d07581e578c96739c315598b3f44a.png](https://s1.imagehub.cc/images/2023/10/31/915d07581e578c96739c315598b3f44a.png)](https://www.imagehub.cc/image/1eZRHr)

!!! note
	The advantages of useing diffusion models for protein design
	* Endlessly diverse outputs
	* Can operate diectly on amino acid coordinates
	* Conveniently guided and conditioned

<a href="https://www.imagehub.cc/image/1eZ8uL"><img src="https://s1.imagehub.cc/images/2023/10/31/d70512564d354ded8019845c24e8399c.png" alt="d70512564d354ded8019845c24e8399c.png" border="0" /></a>

### The representation of the protein structure

<a href="https://www.imagehub.cc/image/1eZk70"><img src="https://s1.imagehub.cc/images/2023/10/31/0e4ab6e29bee546eb3dea18d7b8c6c78.png" alt="0e4ab6e29bee546eb3dea18d7b8c6c78.png" border="0" /></a>

!!! note Frame-based representation
	In an acid amino, the bond of $N-C^\alpha$ and $C^\alpha-C$ are highly fixed and highly constrainted. We the use these two bonds as based-vector to represent the amino. Thus the structure of the protein can be represent a set of above local frames' rotations and translations

#### Noising

<a href="https://www.imagehub.cc/image/1eZ9ER"><img src="https://s1.imagehub.cc/images/2023/10/31/c0a1edc6eee39d48fbea82df925eb80a.png" alt="c0a1edc6eee39d48fbea82df925eb80a.png" border="0" /></a>

 The model noise the translations, rotations and orientation of the local frames.

#### Important property

<a href="https://www.imagehub.cc/image/1eZVST"><img src="https://s1.imagehub.cc/images/2023/10/31/e7d4e31a14ef0d0b2e3335fc50f8b7aa.png" alt="e7d4e31a14ef0d0b2e3335fc50f8b7aa.png" border="0" /></a>

Predicting the noise of  $X_{T-1}$ is the same as directly predicting $X_0$ and then predicting $X_{T-1}$ from $X_0$. This equivalence relationship is very important and leads to our motivation.

### Formulating RoseTTAFold as denoising network

<a href="https://www.imagehub.cc/image/1eZ2ok"><img src="https://s1.imagehub.cc/images/2023/10/31/48cbbcac77058c01c0ceaba435f53436.png" alt="48cbbcac77058c01c0ceaba435f53436.png" border="0" /></a>

We use the pre-tained RoseTTAFold as the backbone of the model. Importantly, the RoseTTAFold already has some equivariant property like SE(3) equivariant.

RFdiffusion changes the input sequence of RoseTTAFold to masked sequence and Diffused coordinates. And let the RF to generate the ground truth structure.

!!! Summary
	In my opinon, the RoseTTAFold is treated as a U-Net like module of the denosing step.

### Self-conditioning

Similar to the recycling method.

<a href="https://www.imagehub.cc/image/1emQqs"><img src="https://s1.imagehub.cc/images/2023/10/31/5c692615294fbc49e160ea22437f94be.png" alt="5c692615294fbc49e160ea22437f94be.png" border="0" /></a>

At each single RFdiffusion step, we input the $\hat{X_t}$ along with the $\hat{X_0}$ last time to predict the $\hat{X_0}$ this time.

This self-conditioning training trick is proved to be effective. As the below figure shows.

<a href="https://www.imagehub.cc/image/1emv8h"><img src="https://s1.imagehub.cc/images/2023/10/31/f5a0241f53f1c804168aa257126da1f4.png" alt="f5a0241f53f1c804168aa257126da1f4.png" border="0" /></a>

### The Inductive bias of RoseTTAFold

As we have mentioned before, the RoseTTAFold model have lots of inductive bias like SE(3) equivariant. And the paper verify it by ablation study.

<a href="https://www.imagehub.cc/image/1emVMr"><img src="https://s1.imagehub.cc/images/2023/10/31/7a59ac89a808f4e1e89085f73deda6a6.png" alt="7a59ac89a808f4e1e89085f73deda6a6.png" border="0" /></a>

And the paper also shows the sequence visualization this.

<a href="https://www.imagehub.cc/image/1emhPv"><img src="https://s1.imagehub.cc/images/2023/10/31/f0bfc94967bd5988be64f6ebdcde74d9.png" alt="f0bfc94967bd5988be64f6ebdcde74d9.png" border="0" /></a>

We can see the model without pre-taining and self-conditioning rarely have $\alpha$ and $\beta$.

### Training details.

* Dataset: PDB
* 200 timesteps
* 8* A100 ~ 4 days

## Experiments

The experiments is based on the following  four tasks.

### **Unconditional protein monomer generation**

<a href="https://www.imagehub.cc/image/1emZWL"><img src="https://s1.imagehub.cc/images/2023/10/31/4bc4126d162208fe55bb4cde9e7bc7e7.png" alt="4bc4126d162208fe55bb4cde9e7bc7e7.png" border="0" /></a>

We can see the RFdiffusion designed proteins hava really high confidence based on AlphaFold even if the number of amino acids is 600. And compared to the former SoTA method RoseTTAFold Hallucination, RFdiffusion shows excellent performance. 

In the last figure, the protein designed have low similarity of pdb bank. So nearly we can determine that the designed protein is totally brand new.

<a href="https://www.imagehub.cc/image/1ezZhk"><img src="https://s1.imagehub.cc/images/2023/10/31/6ed9d8967913b0ae6f7ad5c9c343d349.png" alt="6ed9d8967913b0ae6f7ad5c9c343d349.png" border="0" /></a>

In this figure, we can see the structure designed by RFdiffusion have specific absorption wavelength and extremely themostable. Thus we can say the model have learned some high level information about the protein.

* **RFdiffusion robustly designs specific protein folds**

<a href="https://www.imagehub.cc/image/1ez5nZ"><img src="https://s1.imagehub.cc/images/2023/10/31/622cd358a8c00a312f73defd493a40a1.png" alt="622cd358a8c00a312f73defd493a40a1.png" border="0" /></a>

We can simply input the blokc adjaceny matrix into the model, as I have mentioned above, the diffusion models can be easily conditioned.

The results showed in the following figure verify the ability of RFdiffusion.

<a href="https://www.imagehub.cc/image/1e2fpr"><img src="https://s1.imagehub.cc/images/2023/10/31/737205d3d61d405703053420ce8e0f62.png" alt="737205d3d61d405703053420ce8e0f62.png" border="0" /></a>

!!!  note TIM Barrel
	The TIM barrel (triose-phosphate isomerase), also known as an alpha/beta barrel,[1]: 252  is a conserved protein fold consisting of eight alpha helices (α-helices) and eight parallel beta strands (β-strands) that alternate along the peptide backbone.

<a href="https://www.imagehub.cc/image/1e2CaS"><img src="https://s1.imagehub.cc/images/2023/10/31/21d6a99312d0011f5100f2ee9f910fa4.png" alt="21d6a99312d0011f5100f2ee9f910fa4.png" border="0" /></a>

And we can see the structures are high in silico success rates, which indicates the high designabiliy.


### **high-order symmetric oligomers generation**

I think the symmetric design is the most impressive part of the paper.

<a href="https://www.imagehub.cc/image/1e2Bbg"><img src="https://s1.imagehub.cc/images/2023/10/31/f07f38868e837015a2bf41eb44db4540.png" alt="f07f38868e837015a2bf41eb44db4540.png" border="0" /></a>

The method to design the symmetric oligomers is "taking the point cloud we send to the RFdiffusion each time and take an asymmetirc unit's worth of the residues from tha gaussian distribution and then apply all of the symmetry operator where you are trying to generate proteins."

 As a result, the prediction (noise) $\hat{X_0}$ will be very close to point symmetry.

The experiment result is as follows:

<a href="https://www.imagehub.cc/image/1e2OuR"><img src="https://s1.imagehub.cc/images/2023/10/31/c55fce1c8fc549c6fbfce8d5f702595e.png" alt="c55fce1c8fc549c6fbfce8d5f702595e.png" border="0" />
</a>


We can see the protein designed by the RFdiffusion is almost indistinguishable from AlphaFold2 output.In addition, special symmetries such as dihedral angles can be designed

### **Functional-site scaffolding**

<a href="https://www.imagehub.cc/image/1e20e0"><img src="https://s1.imagehub.cc/images/2023/10/31/f628f294b8c028c8ecc2d2d1d7a8b361.png" alt="f628f294b8c028c8ecc2d2d1d7a8b361.png" border="0" /></a>

And the corresponding testing result is as follows:

<a href="https://www.imagehub.cc/image/1e23sz"><img src="https://s1.imagehub.cc/images/2023/10/31/c9674af9d0a963c08c9764cf1fd29a3d.png" alt="c9674af9d0a963c08c9764cf1fd29a3d.png" border="0" /></a>

We can see the RFdiffusion method outperforms all of the previous method and get awsome score at the in silico success rate.

And we can combine the motif scaffolding protocol with the oligomers generation protocal to design symmetric specific functional protein.

<a href="https://www.imagehub.cc/image/1e26pj"><img src="https://s1.imagehub.cc/images/2023/10/31/ef8a88b9aa1435700340de5d743ee44f.png" alt="ef8a88b9aa1435700340de5d743ee44f.png" border="0" /></a>

### **De novo peptide binder design**

<a href="https://www.imagehub.cc/image/1e2gBB"><img src="https://s1.imagehub.cc/images/2023/10/31/5eaa5b49a9da2df408046019fb1327c4.png" alt="5eaa5b49a9da2df408046019fb1327c4.png" border="0" /></a>

That is very relvant to disease diagnosis and treatment. What we want is input the peptide and get the corresponding binders.